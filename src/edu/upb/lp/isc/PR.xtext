grammar edu.upb.lp.isc.PR with org.eclipse.xtext.common.Terminals

generate pR "http://www.upb.edu/lp/isc/PR"

Programa:
	';' 'Author:' STRING
	';' name=ID	
	(definiciones+=Definicion)*
	('?' ejecuciones+=(Expresion))*
	//|'('Expresion')'
;


Variable:
	//(define id expr)
	name=ID
;

Definicion:
	{Definicion}
	//(define (head args) body ...+)
	//value = (STRING | 'TRUE' | 'FALSE')
	'(''define''('name=ID (args+=Variable)*')'
		e=Expresion
	')'
;

//Definicion:
//	{Definicion}
//	//(define (head args) body ...+)
//	//value = (STRING | 'TRUE' | 'FALSE')
//	'(''define''('name=ID (args+=Argumento)*')'
//		'('definicion=[Definicion] (valores+=Expresion)+')'
//	')'
//;
Expresion:
	(IntExpr | StringExpr | BooleanExpr | 
	IfExpr | CallExpr | ListExpr | RefVariable | ReadExpr)
;

//Statics
StringValue:
	str = STRING
;

IntValue:
	val = INT
;

IntExpr:
	IntValue | Sum | Mult | Res | Div
;

VariableRef:
	var=[Variable]
;
Sum:
	{Sum}
	'(''+' value+=(IntExpr|CallExpr|VariableRef)*')'
;

Mult:
	{Mult}
	'(''*' value+=(IntExpr|CallExpr|VariableRef)*')'
;

Res:
	{Res}
	'(''-' value+=(IntExpr|CallExpr|VariableRef)*')'
;

Div:
	{Div}
	'(''/' value+=(IntExpr|CallExpr|VariableRef)*')'
;

StringExpr:
	str = StringValue
;

BooleanExpr:
	{BooleanExpr}
	('true' | 'false')
;

ExprValue:
	exp = Expresion
;

ReadExpr:
	ID
;
//////////////

CallExpr:
	'('definicion=[Definicion] parametros+=(Expresion)*')'
;


RefVariable:
	ref = [Variable]
;

IfExpr:
	{IfExpr}
	//TODO hacer un if
	'('
	
	IfExpr=BooleanExpr IfTrue=BooleanExpr IfFalse=BooleanExpr
	//nani
	')'
;

ListExpr:
	//ConsValue|
	ListValue|ComplexListExpr

;

/* 
ConsValue:
	{ConsValue}
	'(''cons' '\''(expr+=Expresion)* (expr+=Expresion)*')'
;
*/


ListValue:
	{ListValue}
	'(''list' (Expr+=Expresion
		     (','Expr+=Expresion)*)?  ')'
;

ComplexListExpr:
		'(' op=ListOp (expr+=ListExpr)*')'
;

ListOp:
//	op=('car'|'cdr'|'length')
op=(Car|Cdr)
;
Car:
	car='car'
;
Cdr:
	cdr='cdr'
;

WhileExpr:
	'while''('/*boolean expr*/')''{'
		expresiones+=[Expresion]
		
	'}'
;